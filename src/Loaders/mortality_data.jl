"""
Embedded SOA Mortality Table Data.

[T1] Source: Society of Actuaries, 2012 Individual Annuity Reserving Table

Data includes:
- SOA 2012 IAM Basic Table - Male (ages 0-120)
- SOA 2012 IAM Basic Table - Female (ages 0-120)

Validators: actuarialmath, MortalityTables.jl
See: docs/CROSS_VALIDATION_MATRIX.md
"""

# ============================================================================
# SOA 2012 IAM Basic Table - Male [T1]
# ============================================================================

"""
SOA 2012 IAM Basic Table - Male.

[T1] qx = probability of death between age x and x+1

Source: Society of Actuaries, 2012 Individual Annuity Reserving Table
Table ID: 3302
Ages: 0-120
"""
const SOA_2012_IAM_MALE_QX = Dict{Int, Float64}(
    0 => 0.00066, 1 => 0.00044, 2 => 0.00029, 3 => 0.00023, 4 => 0.00018,
    5 => 0.00016, 6 => 0.00015, 7 => 0.00014, 8 => 0.00013, 9 => 0.00012,
    10 => 0.00012, 11 => 0.00013, 12 => 0.00016, 13 => 0.00022, 14 => 0.00031,
    15 => 0.00041, 16 => 0.00052, 17 => 0.00063, 18 => 0.00073, 19 => 0.00080,
    20 => 0.00084, 21 => 0.00087, 22 => 0.00088, 23 => 0.00089, 24 => 0.00089,
    25 => 0.00088, 26 => 0.00088, 27 => 0.00088, 28 => 0.00089, 29 => 0.00091,
    30 => 0.00093, 31 => 0.00096, 32 => 0.00100, 33 => 0.00104, 34 => 0.00109,
    35 => 0.00115, 36 => 0.00121, 37 => 0.00129, 38 => 0.00137, 39 => 0.00147,
    40 => 0.00158, 41 => 0.00170, 42 => 0.00184, 43 => 0.00199, 44 => 0.00216,
    45 => 0.00235, 46 => 0.00256, 47 => 0.00280, 48 => 0.00306, 49 => 0.00336,
    50 => 0.00369, 51 => 0.00405, 52 => 0.00446, 53 => 0.00491, 54 => 0.00542,
    55 => 0.00598, 56 => 0.00661, 57 => 0.00731, 58 => 0.00809, 59 => 0.00897,
    60 => 0.00994, 61 => 0.01103, 62 => 0.01224, 63 => 0.01360, 64 => 0.01511,
    65 => 0.01680, 66 => 0.01868, 67 => 0.02079, 68 => 0.02315, 69 => 0.02580,
    70 => 0.02876, 71 => 0.03208, 72 => 0.03580, 73 => 0.03997, 74 => 0.04464,
    75 => 0.04988, 76 => 0.05574, 77 => 0.06231, 78 => 0.06966, 79 => 0.07790,
    80 => 0.08712, 81 => 0.09745, 82 => 0.10901, 83 => 0.12194, 84 => 0.13638,
    85 => 0.15249, 86 => 0.17043, 87 => 0.19037, 88 => 0.21248, 89 => 0.23691,
    90 => 0.26379, 91 => 0.29323, 92 => 0.32532, 93 => 0.36011, 94 => 0.39759,
    95 => 0.43769, 96 => 0.48025, 97 => 0.52503, 98 => 0.57171, 99 => 0.61989,
    100 => 0.66912, 101 => 0.71888, 102 => 0.76861, 103 => 0.81769, 104 => 0.86551,
    105 => 0.91142, 106 => 0.95479, 107 => 0.99500, 108 => 1.00000, 109 => 1.00000,
    110 => 1.00000, 111 => 1.00000, 112 => 1.00000, 113 => 1.00000, 114 => 1.00000,
    115 => 1.00000, 116 => 1.00000, 117 => 1.00000, 118 => 1.00000, 119 => 1.00000,
    120 => 1.00000
)

# ============================================================================
# SOA 2012 IAM Basic Table - Female [T1]
# ============================================================================

"""
SOA 2012 IAM Basic Table - Female.

[T1] Generally lower mortality than male at most ages.

Source: Society of Actuaries, 2012 Individual Annuity Reserving Table
Table ID: 3303
Ages: 0-120
"""
const SOA_2012_IAM_FEMALE_QX = Dict{Int, Float64}(
    0 => 0.00055, 1 => 0.00037, 2 => 0.00024, 3 => 0.00019, 4 => 0.00015,
    5 => 0.00013, 6 => 0.00012, 7 => 0.00011, 8 => 0.00011, 9 => 0.00010,
    10 => 0.00010, 11 => 0.00011, 12 => 0.00013, 13 => 0.00017, 14 => 0.00022,
    15 => 0.00027, 16 => 0.00032, 17 => 0.00036, 18 => 0.00039, 19 => 0.00041,
    20 => 0.00042, 21 => 0.00043, 22 => 0.00044, 23 => 0.00045, 24 => 0.00046,
    25 => 0.00047, 26 => 0.00048, 27 => 0.00050, 28 => 0.00052, 29 => 0.00055,
    30 => 0.00058, 31 => 0.00062, 32 => 0.00066, 33 => 0.00071, 34 => 0.00077,
    35 => 0.00083, 36 => 0.00090, 37 => 0.00098, 38 => 0.00107, 39 => 0.00117,
    40 => 0.00128, 41 => 0.00140, 42 => 0.00154, 43 => 0.00169, 44 => 0.00185,
    45 => 0.00203, 46 => 0.00223, 47 => 0.00245, 48 => 0.00269, 49 => 0.00296,
    50 => 0.00325, 51 => 0.00357, 52 => 0.00393, 53 => 0.00432, 54 => 0.00475,
    55 => 0.00523, 56 => 0.00576, 57 => 0.00635, 58 => 0.00700, 59 => 0.00773,
    60 => 0.00854, 61 => 0.00944, 62 => 0.01044, 63 => 0.01156, 64 => 0.01281,
    65 => 0.01420, 66 => 0.01576, 67 => 0.01750, 68 => 0.01946, 69 => 0.02165,
    70 => 0.02411, 71 => 0.02688, 72 => 0.02999, 73 => 0.03349, 74 => 0.03743,
    75 => 0.04186, 76 => 0.04683, 77 => 0.05242, 78 => 0.05869, 79 => 0.06573,
    80 => 0.07361, 81 => 0.08245, 82 => 0.09234, 83 => 0.10341, 84 => 0.11578,
    85 => 0.12960, 86 => 0.14502, 87 => 0.16220, 88 => 0.18130, 89 => 0.20246,
    90 => 0.22582, 91 => 0.25150, 92 => 0.27960, 93 => 0.31019, 94 => 0.34330,
    95 => 0.37893, 96 => 0.41701, 97 => 0.45741, 98 => 0.49994, 99 => 0.54433,
    100 => 0.59025, 101 => 0.63732, 102 => 0.68510, 103 => 0.73315, 104 => 0.78099,
    105 => 0.82815, 106 => 0.87414, 107 => 0.91849, 108 => 0.96073, 109 => 1.00000,
    110 => 1.00000, 111 => 1.00000, 112 => 1.00000, 113 => 1.00000, 114 => 1.00000,
    115 => 1.00000, 116 => 1.00000, 117 => 1.00000, 118 => 1.00000, 119 => 1.00000,
    120 => 1.00000
)

# ============================================================================
# SOA Table ID Mapping
# ============================================================================

"""
SOA table ID to name mapping.
"""
const SOA_TABLE_IDS = Dict{Int, String}(
    3302 => "SOA 2012 IAM Basic - Male",
    3303 => "SOA 2012 IAM Basic - Female"
)

# ============================================================================
# Treasury Curve Standard Maturities
# ============================================================================

"""
Standard US Treasury maturities in years.

Used for yield curve construction and interpolation.
"""
const TREASURY_MATURITIES = [
    1/12,   # 1 month
    2/12,   # 2 month
    3/12,   # 3 month
    6/12,   # 6 month
    1.0,    # 1 year
    2.0,    # 2 year
    3.0,    # 3 year
    5.0,    # 5 year
    7.0,    # 7 year
    10.0,   # 10 year
    20.0,   # 20 year
    30.0    # 30 year
]

"""
FRED series IDs for Treasury rates (for documentation/future integration).
"""
const FRED_TREASURY_SERIES = Dict{Float64, String}(
    1/12 => "DGS1MO",
    2/12 => "DGS2MO",
    3/12 => "DGS3MO",
    6/12 => "DGS6MO",
    1.0 => "DGS1",
    2.0 => "DGS2",
    3.0 => "DGS3",
    5.0 => "DGS5",
    7.0 => "DGS7",
    10.0 => "DGS10",
    20.0 => "DGS20",
    30.0 => "DGS30"
)

# ============================================================================
# Key Reference Points [T2]
# ============================================================================

"""
Key mortality reference points for validation.

[T2] These values are from SOA 2012 IAM Male table and should be used
to verify correct table loading.
"""
const SOA_2012_IAM_MALE_KEY_POINTS = Dict{Int, Float64}(
    0 => 0.00066,   # Infant mortality
    25 => 0.00088,  # Young adult
    45 => 0.00235,  # Middle age
    65 => 0.01680,  # Standard retirement age
    75 => 0.04988,  # Late retirement
    85 => 0.15249,  # Advanced age
    100 => 0.66912, # Centenarian
    120 => 1.00000  # Terminal age
)

"""
Key mortality reference points for female table.
"""
const SOA_2012_IAM_FEMALE_KEY_POINTS = Dict{Int, Float64}(
    0 => 0.00055,
    25 => 0.00047,
    45 => 0.00203,
    65 => 0.01420,  # Lower than male
    75 => 0.04186,
    85 => 0.12960,
    100 => 0.59025,
    120 => 1.00000
)

# ============================================================================
# Utility Functions for Data Access
# ============================================================================

"""
Get SOA 2012 IAM qx data as a vector for a given gender.

# Arguments
- `gender::Gender`: MALE or FEMALE

# Returns
- `Vector{Float64}`: qx values from age 0 to 120
"""
function get_soa_2012_iam_qx_vector(gender::Gender)::Vector{Float64}
    qx_dict = gender == MALE ? SOA_2012_IAM_MALE_QX : SOA_2012_IAM_FEMALE_QX
    [qx_dict[age] for age in 0:120]
end

"""
Get minimum and maximum ages in SOA 2012 IAM tables.
"""
function get_soa_2012_iam_age_range()
    (min_age = 0, max_age = 120)
end
